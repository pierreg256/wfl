// Generated by CoffeeScript 1.3.3
(function() {
  var inspect, models;

  inspect = (require('eyes')).inspector();

  models = require("../lib/models");

  exports.run = function(options) {
    var decider, decisionTaskOptions;
    decisionTaskOptions = {
      'accessKeyId': options.accessKeyId,
      'secretAccessKey': options.secretAccessKey,
      'region': options.region,
      'domain': options.domain,
      'taskList': {
        'name': options.taskList
      }
    };
    return decider = new models.Decider(decisionTaskOptions, function(error, decisionTask) {
      if (typeof err !== "undefined" && err !== null) {
        return inspect(error, "Got the following error");
      } else {
        inspect(decisionTask.task, "Got the following decision task");
        if (decisionTask.isFailedActivity("hello", "world")) {
          decisionTask.failWorkflowExecution("Hello or activity task failed", decisionTask.workflowHistory);
          return;
        }
        if (decisionTask.isCancelledActivity("hello", "world")) {
          decisionTask.failWorkflowExecution("Hello or activity task cancelled", decisionTask.workflowHistory);
          return;
        }
        if (decisionTask.isTaskCompleted("hello")) {
          return decisionTask.scheduleActivityTask("world", decisionTask.activityTaskCompletedResult("hello"));
        } else {
          return decisionTask.scheduleActivityTask("hello", decisionTask.workflowInput);
        }
      }
    });
  };

}).call(this);
